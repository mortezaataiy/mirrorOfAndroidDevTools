name: Android Version Compatibility Checker

on:
  workflow_dispatch:
    inputs:
      force_run:
        description: 'Force run even if no changes detected'
        required: false
        default: 'false'
        type: boolean
  schedule:
    # Ø§Ø¬Ø±Ø§ÛŒ Ù‡ÙØªÚ¯ÛŒ Ø¯Ø± Ø±ÙˆØ² ÛŒÚ©Ø´Ù†Ø¨Ù‡ Ø³Ø§Ø¹Øª 2 ØµØ¨Ø­ UTC
    - cron: '0 2 * * 0'
  push:
    branches: [ main ]
    paths:
      - 'scripts/**'
      - '.github/workflows/android-version-checker.yml'

jobs:
  check-android-versions:
    runs-on: windows-latest
    timeout-minutes: 60
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Setup PowerShell execution policy
      shell: powershell
      run: |
        Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser -Force
        Write-Host "âœ… PowerShell execution policy set to RemoteSigned"
    
    - name: Initialize logging
      shell: powershell
      run: |
        Write-Host "ğŸš€ Ø´Ø±ÙˆØ¹ Ø¨Ø±Ø±Ø³ÛŒ Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ ÙˆØ±Ú˜Ù†â€ŒÙ‡Ø§ÛŒ Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯" -ForegroundColor Cyan
        Write-Host "ğŸ“… ØªØ§Ø±ÛŒØ® Ø§Ø¬Ø±Ø§: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')" -ForegroundColor Yellow
        Write-Host "ğŸ–¥ï¸ Ù…Ø­ÛŒØ· Ø§Ø¬Ø±Ø§: $env:RUNNER_OS" -ForegroundColor Yellow
        
        # Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø§ÛŒØ±Ú©ØªÙˆØ±ÛŒ Ù„Ø§Ú¯
        New-Item -ItemType Directory -Path "logs" -Force | Out-Null
        
    - name: Import PowerShell modules
      shell: powershell
      run: |
        Write-Host "ğŸ“¦ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ PowerShell..." -ForegroundColor Yellow
        
        # Import all required modules
        . ".\scripts\ErrorHandler.ps1"
        . ".\scripts\VersionDiscovery.ps1"
        . ".\scripts\DownloadValidator.ps1"
        . ".\scripts\ToolInstaller.ps1"
        . ".\scripts\HelloWorldBuilder.ps1"
        . ".\scripts\YamlDatabaseManager.ps1"
        
        Write-Host "âœ… ØªÙ…Ø§Ù… Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù†Ø¯" -ForegroundColor Green
        
    - name: Discover latest versions
      shell: powershell
      run: |
        Write-Host "ğŸ” Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø¢Ø®Ø±ÛŒÙ† ÙˆØ±Ú˜Ù†â€ŒÙ‡Ø§ÛŒ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯..." -ForegroundColor Cyan
        
        # Import modules
        . ".\scripts\ErrorHandler.ps1"
        . ".\scripts\VersionDiscovery.ps1"
        
        try {
            # Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ ØªÙ…Ø§Ù… Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§
            $tools = Get-AllLatestVersions
            
            if ($tools.Count -eq 0) {
                throw "Ù‡ÛŒÚ† Ø§Ø¨Ø²Ø§Ø±ÛŒ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù†Ø´Ø¯"
            }
            
            Write-Host "âœ… $($tools.Count) Ø§Ø¨Ø²Ø§Ø± Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø´Ø¯" -ForegroundColor Green
            
            # Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ Ø¨Ø±Ø§ÛŒ Ù…Ø±Ø§Ø­Ù„ Ø¨Ø¹Ø¯ÛŒ
            $toolsJson = $tools | ConvertTo-Json -Depth 3
            $toolsJson | Out-File -FilePath "discovered-tools.json" -Encoding UTF8
            
            # Ù†Ù…Ø§ÛŒØ´ Ø®Ù„Ø§ØµÙ‡
            foreach ($tool in $tools) {
                Write-Host "  ğŸ“‹ $($tool.Name) v$($tool.Version)" -ForegroundColor White
            }
        }
        catch {
            Write-Error "âŒ Ø®Ø·Ø§ Ø¯Ø± Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ ÙˆØ±Ú˜Ù†â€ŒÙ‡Ø§: $($_.Exception.Message)"
            exit 1
        }
        
    - name: Validate download links
      shell: powershell
      run: |
        Write-Host "ğŸ”— Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ù†Ù„ÙˆØ¯..." -ForegroundColor Cyan
        
        # Import modules
        . ".\scripts\ErrorHandler.ps1"
        . ".\scripts\DownloadValidator.ps1"
        
        try {
            # Ø®ÙˆØ§Ù†Ø¯Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§
            $toolsJson = Get-Content -Path "discovered-tools.json" -Raw
            $tools = $toolsJson | ConvertFrom-Json
            
            $validationResults = @{}
            $validCount = 0
            
            foreach ($tool in $tools) {
                Write-Host "  ğŸ” ØªØ³Øª $($tool.Name)..." -ForegroundColor Yellow
                
                $validation = Test-DownloadLink -Url $tool.DownloadUrl -MinSize 1MB
                $validationResults[$tool.Name] = $validation
                
                if ($validation.Valid) {
                    Write-Host "    âœ… Ù…Ø¹ØªØ¨Ø± - Ø§Ù†Ø¯Ø§Ø²Ù‡: $([math]::Round($validation.Size/1MB, 2)) MB" -ForegroundColor Green
                    $validCount++
                }
                else {
                    Write-Host "    âŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø±: $($validation.Error)" -ForegroundColor Red
                }
            }
            
            Write-Host "âœ… $validCount Ø§Ø² $($tools.Count) Ù„ÛŒÙ†Ú© Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª" -ForegroundColor Green
            
            # Ø°Ø®ÛŒØ±Ù‡ Ù†ØªØ§ÛŒØ¬ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ
            $validationResults | ConvertTo-Json -Depth 3 | Out-File -FilePath "validation-results.json" -Encoding UTF8
            
            if ($validCount -eq 0) {
                throw "Ù‡ÛŒÚ† Ù„ÛŒÙ†Ú© Ù…Ø¹ØªØ¨Ø±ÛŒ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯"
            }
        }
        catch {
            Write-Error "âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§: $($_.Exception.Message)"
            exit 1
        }
        
    - name: Install Android development tools
      shell: powershell
      run: |
        Write-Host "âš™ï¸ Ù†ØµØ¨ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡ Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯..." -ForegroundColor Cyan
        
        # Import modules
        . ".\scripts\ErrorHandler.ps1"
        . ".\scripts\VersionDiscovery.ps1"
        . ".\scripts\DownloadValidator.ps1"
        . ".\scripts\ToolInstaller.ps1"
        
        try {
            # Ø®ÙˆØ§Ù†Ø¯Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§
            $toolsJson = Get-Content -Path "discovered-tools.json" -Raw
            $tools = $toolsJson | ConvertFrom-Json
            
            # ØªØ¨Ø¯ÛŒÙ„ Ø§Ø² JSON Ø¨Ù‡ ToolInfo objects
            $toolObjects = @()
            foreach ($tool in $tools) {
                $toolObj = [ToolInfo]::new($tool.Name)
                $toolObj.Version = $tool.Version
                $toolObj.DownloadUrl = $tool.DownloadUrl
                $toolObj.FileType = $tool.FileType
                $toolObjects += $toolObj
            }
            
            # Ù†ØµØ¨ ØªÙ…Ø§Ù… Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§
            $installResult = Install-AllTools -Tools $toolObjects
            
            if ($installResult) {
                Write-Host "âœ… ØªÙ…Ø§Ù… Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ù†ØµØ¨ Ø´Ø¯Ù†Ø¯" -ForegroundColor Green
            }
            else {
                Write-Host "âš ï¸ Ø¨Ø±Ø®ÛŒ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ Ù†ØµØ¨ Ù†Ø´Ø¯Ù†Ø¯" -ForegroundColor Yellow
            }
            
            # Ø°Ø®ÛŒØ±Ù‡ Ù†ØªØ§ÛŒØ¬ Ù†ØµØ¨
            $installResults = @{}
            foreach ($tool in $toolObjects) {
                $installResults[$tool.Name] = @{
                    Status = $tool.TestStatus
                    InstallPath = $tool.InstallPath
                    FileSize = $tool.FileSize
                }
            }
            $installResults | ConvertTo-Json -Depth 3 | Out-File -FilePath "install-results.json" -Encoding UTF8
            
            # Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯Ù‡ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§
            $toolObjects | ConvertTo-Json -Depth 3 | Out-File -FilePath "installed-tools.json" -Encoding UTF8
        }
        catch {
            Write-Error "âŒ Ø®Ø·Ø§ Ø¯Ø± Ù†ØµØ¨ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§: $($_.Exception.Message)"
            
            # Ø°Ø®ÛŒØ±Ù‡ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø®Ø·Ø§
            Save-LogsToFile -OutputPath "logs"
            exit 1
        }
        
    - name: Create and build Hello World project
      shell: powershell
      run: |
        Write-Host "ğŸ—ï¸ Ø§ÛŒØ¬Ø§Ø¯ Ùˆ Ø¨ÛŒÙ„Ø¯ Ù¾Ø±ÙˆÚ˜Ù‡ Hello World..." -ForegroundColor Cyan
        
        # Import modules
        . ".\scripts\ErrorHandler.ps1"
        . ".\scripts\HelloWorldBuilder.ps1"
        
        try {
            # Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø§ÛŒØ±Ú©ØªÙˆØ±ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡
            $projectDir = "HelloWorldProjects"
            New-Item -ItemType Directory -Path $projectDir -Force | Out-Null
            
            # Ø§ÛŒØ¬Ø§Ø¯ Ù¾Ø±ÙˆÚ˜Ù‡ Ú©Ø§Ù…Ù„
            $projectResult = New-CompleteHelloWorldProject -ProjectPath $projectDir
            
            if ($projectResult.Success) {
                Write-Host "âœ… Ù¾Ø±ÙˆÚ˜Ù‡ Hello World Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§ÛŒØ¬Ø§Ø¯ Ùˆ Ø¨ÛŒÙ„Ø¯ Ø´Ø¯" -ForegroundColor Green
                
                # Ø¨Ø±Ø±Ø³ÛŒ ÙØ§ÛŒÙ„ APK
                if ($projectResult.BuildResult.ApkPath -and (Test-Path $projectResult.BuildResult.ApkPath)) {
                    $apkSize = (Get-Item $projectResult.BuildResult.ApkPath).Length
                    Write-Host "ğŸ“± ÙØ§ÛŒÙ„ APK ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯: $([math]::Round($apkSize/1MB, 2)) MB" -ForegroundColor Green
                    
                    # Ú©Ù¾ÛŒ APK Ø¨Ù‡ artifacts
                    Copy-Item $projectResult.BuildResult.ApkPath -Destination "hello-world-test.apk"
                }
                
                # Ø°Ø®ÛŒØ±Ù‡ Ù†ØªØ§ÛŒØ¬ Ø¨ÛŒÙ„Ø¯
                $buildResults = @{
                    Success = $projectResult.Success
                    ProjectPath = $projectResult.ProjectPath
                    ApkPath = $projectResult.BuildResult.ApkPath
                    ApkSize = if ($projectResult.BuildResult.ApkSize) { $projectResult.BuildResult.ApkSize } else { 0 }
                    ApkValid = $projectResult.BuildResult.ApkValid
                }
                $buildResults | ConvertTo-Json -Depth 3 | Out-File -FilePath "build-results.json" -Encoding UTF8
            }
            else {
                throw "Ø§ÛŒØ¬Ø§Ø¯ ÛŒØ§ Ø¨ÛŒÙ„Ø¯ Ù¾Ø±ÙˆÚ˜Ù‡ Hello World Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯: $($projectResult.Error)"
            }
        }
        catch {
            Write-Error "âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ÛŒØ¬Ø§Ø¯ Ù¾Ø±ÙˆÚ˜Ù‡ Hello World: $($_.Exception.Message)"
            
            # Ø°Ø®ÛŒØ±Ù‡ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø®Ø·Ø§
            Save-LogsToFile -OutputPath "logs"
            exit 1
        }
        
    - name: Update version database
      shell: powershell
      run: |
        Write-Host "ğŸ’¾ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ ÙˆØ±Ú˜Ù†â€ŒÙ‡Ø§..." -ForegroundColor Cyan
        
        # Import modules
        . ".\scripts\ErrorHandler.ps1"
        . ".\scripts\VersionDiscovery.ps1"
        . ".\scripts\YamlDatabaseManager.ps1"
        
        try {
            # Ø®ÙˆØ§Ù†Ø¯Ù† Ù†ØªØ§ÛŒØ¬ Ù…Ø±Ø§Ø­Ù„ Ù‚Ø¨Ù„ÛŒ
            $toolsJson = Get-Content -Path "installed-tools.json" -Raw -ErrorAction SilentlyContinue
            $buildResultsJson = Get-Content -Path "build-results.json" -Raw -ErrorAction SilentlyContinue
            
            if ($toolsJson) {
                $tools = $toolsJson | ConvertFrom-Json
                
                # ØªØ¨Ø¯ÛŒÙ„ Ø§Ø² JSON Ø¨Ù‡ ToolInfo objects
                $toolObjects = @()
                foreach ($tool in $tools) {
                    $toolObj = [ToolInfo]::new($tool.Name)
                    $toolObj.Version = $tool.Version
                    $toolObj.DownloadUrl = $tool.DownloadUrl
                    $toolObj.FileType = $tool.FileType
                    $toolObj.TestStatus = $tool.TestStatus
                    $toolObj.InstallPath = $tool.InstallPath
                    $toolObj.FileSize = $tool.FileSize
                    $toolObj.TestDate = [datetime]$tool.TestDate
                    $toolObjects += $toolObj
                }
                
                # Ø¨Ø±Ø±Ø³ÛŒ Ù…ÙˆÙÙ‚ÛŒØª Ø¨ÛŒÙ„Ø¯ Hello World
                $helloWorldSuccess = $false
                if ($buildResultsJson) {
                    $buildResults = $buildResultsJson | ConvertFrom-Json
                    $helloWorldSuccess = $buildResults.Success
                }
                
                # Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡
                $updateResult = Update-VersionDatabase -Tools $toolObjects -OutputPath "." -HelloWorldBuildSuccess $helloWorldSuccess
                
                if ($updateResult.Success) {
                    Write-Host "âœ… Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯" -ForegroundColor Green
                    Write-Host "ğŸ“Š $($updateResult.ToolsCount) Ø§Ø¨Ø²Ø§Ø±ØŒ $($updateResult.SuccessfulInstalls) Ù†ØµØ¨ Ù…ÙˆÙÙ‚" -ForegroundColor Green
                }
                else {
                    throw "Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯: $($updateResult.Error)"
                }
            }
            else {
                Write-Host "âš ï¸ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ ÛŒØ§ÙØª Ù†Ø´Ø¯" -ForegroundColor Yellow
            }
        }
        catch {
            Write-Error "âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡: $($_.Exception.Message)"
            
            # Ø°Ø®ÛŒØ±Ù‡ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø®Ø·Ø§
            Save-LogsToFile -OutputPath "logs"
        }
        
    - name: Generate summary report
      shell: powershell
      run: |
        Write-Host "ğŸ“‹ ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´ Ø®Ù„Ø§ØµÙ‡..." -ForegroundColor Cyan
        
        # Import modules
        . ".\scripts\ErrorHandler.ps1"
        
        try {
            $summary = @"
# Ú¯Ø²Ø§Ø±Ø´ Ø¨Ø±Ø±Ø³ÛŒ Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ ÙˆØ±Ú˜Ù†â€ŒÙ‡Ø§ÛŒ Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯

## Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø¬Ø±Ø§
- **ØªØ§Ø±ÛŒØ® Ø§Ø¬Ø±Ø§**: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')
- **Ù…Ø­ÛŒØ· Ø§Ø¬Ø±Ø§**: $env:RUNNER_OS
- **GitHub Run ID**: $env:GITHUB_RUN_ID

## Ù†ØªØ§ÛŒØ¬
"@
            
            # Ø®ÙˆØ§Ù†Ø¯Ù† Ù†ØªØ§ÛŒØ¬ Ù…Ø®ØªÙ„Ù
            if (Test-Path "discovered-tools.json") {
                $tools = Get-Content "discovered-tools.json" | ConvertFrom-Json
                $summary += "`n### Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø´Ø¯Ù‡ ($($tools.Count))`n"
                foreach ($tool in $tools) {
                    $summary += "- **$($tool.Name)** v$($tool.Version)`n"
                }
            }
            
            if (Test-Path "install-results.json") {
                $installResults = Get-Content "install-results.json" | ConvertFrom-Json
                $successCount = 0
                $summary += "`n### Ù†ØªØ§ÛŒØ¬ Ù†ØµØ¨`n"
                foreach ($toolName in $installResults.PSObject.Properties.Name) {
                    $result = $installResults.$toolName
                    $status = if ($result.Status -eq "installed") { "âœ… Ù…ÙˆÙÙ‚" } else { "âŒ Ù†Ø§Ù…ÙˆÙÙ‚" }
                    $summary += "- **$toolName**: $status`n"
                    if ($result.Status -eq "installed") { $successCount++ }
                }
                $summary += "`n**Ø®Ù„Ø§ØµÙ‡ Ù†ØµØ¨**: $successCount Ø§Ø² $($installResults.PSObject.Properties.Count) Ø§Ø¨Ø²Ø§Ø± Ù…ÙˆÙÙ‚`n"
            }
            
            if (Test-Path "build-results.json") {
                $buildResults = Get-Content "build-results.json" | ConvertFrom-Json
                $summary += "`n### Ù†ØªØ§ÛŒØ¬ Ø¨ÛŒÙ„Ø¯ Hello World`n"
                if ($buildResults.Success) {
                    $summary += "- âœ… **Ø¨ÛŒÙ„Ø¯ Ù…ÙˆÙÙ‚**`n"
                    if ($buildResults.ApkSize -gt 0) {
                        $apkSizeMB = [math]::Round($buildResults.ApkSize/1MB, 2)
                        $summary += "- ğŸ“± **Ø§Ù†Ø¯Ø§Ø²Ù‡ APK**: $apkSizeMB MB`n"
                    }
                }
                else {
                    $summary += "- âŒ **Ø¨ÛŒÙ„Ø¯ Ù†Ø§Ù…ÙˆÙÙ‚**`n"
                }
            }
            
            # Ù†Ù…Ø§ÛŒØ´ Ø®Ù„Ø§ØµÙ‡ Ø®Ø·Ø§Ù‡Ø§
            Show-ErrorSummary
            Show-ActivitySummary
            
            # Ø°Ø®ÛŒØ±Ù‡ Ú¯Ø²Ø§Ø±Ø´
            $summary | Out-File -FilePath "summary-report.md" -Encoding UTF8
            
            Write-Host "âœ… Ú¯Ø²Ø§Ø±Ø´ Ø®Ù„Ø§ØµÙ‡ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯" -ForegroundColor Green
            Write-Host $summary
        }
        catch {
            Write-Error "âŒ Ø®Ø·Ø§ Ø¯Ø± ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´: $($_.Exception.Message)"
        }
        
    - name: Save logs and artifacts
      shell: powershell
      run: |
        Write-Host "ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ Ù„Ø§Ú¯â€ŒÙ‡Ø§ Ùˆ artifacts..." -ForegroundColor Cyan
        
        # Import modules
        . ".\scripts\ErrorHandler.ps1"
        
        # Ø°Ø®ÛŒØ±Ù‡ Ù„Ø§Ú¯â€ŒÙ‡Ø§
        Save-LogsToFile -OutputPath "logs"
        
        Write-Host "âœ… Ù„Ø§Ú¯â€ŒÙ‡Ø§ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù†Ø¯" -ForegroundColor Green
        
    - name: Upload artifacts
      uses: actions/upload-artifact@v4
      if: always()
      with:
        name: android-version-check-results
        path: |
          android-tools-versions.yml
          summary-report.md
          logs/
          *.json
          hello-world-test.apk
        retention-days: 30
        
    - name: Commit updated database
      if: success()
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        
        if (Test-Path "android-tools-versions.yml") {
          git add android-tools-versions.yml
          
          $changes = git diff --cached --name-only
          if ($changes) {
            git commit -m "ğŸ¤– Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ ÙˆØ±Ú˜Ù†â€ŒÙ‡Ø§ÛŒ Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯
            
            - ØªØ§Ø±ÛŒØ® Ø¨Ø±Ø±Ø³ÛŒ: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')
            - GitHub Run: $env:GITHUB_RUN_ID
            - ØªØºÛŒÛŒØ±Ø§Øª: $($changes -join ', ')"
            
            git push
            Write-Host "âœ… ØªØºÛŒÛŒØ±Ø§Øª commit Ùˆ push Ø´Ø¯Ù†Ø¯" -ForegroundColor Green
          }
          else {
            Write-Host "â„¹ï¸ ØªØºÛŒÛŒØ±ÛŒ Ø¨Ø±Ø§ÛŒ commit ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯" -ForegroundColor Yellow
          }
        }
        else {
          Write-Host "âš ï¸ ÙØ§ÛŒÙ„ Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ ÛŒØ§ÙØª Ù†Ø´Ø¯" -ForegroundColor Yellow
        }
      shell: powershell