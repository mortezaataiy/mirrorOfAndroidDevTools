# برنامه پیاده‌سازی: GitHub Actions Workflow

## نمای کلی

این برنامه پیاده‌سازی یک GitHub Actions workflow جامع و نهایی را ایجاد می‌کند که تمام ابزارهای توسعه اندروید مورد نیاز را برای استفاده کاملاً آفلاین دانلود، اعتبارسنجی و بسته‌بندی می‌کند.

## وظایف

- [x] 1. ایجاد workflow اصلی با ساختار پایه
  - ایجاد فایل `.github/workflows/android-offline-complete.yml`
  - تنظیم trigger های workflow (workflow_dispatch)
  - تعریف job اصلی با Ubuntu runner
  - _الزامات: ۸.۱، ۸.۲_

- [x] 2. پیاده‌سازی سیستم دانلود و اعتبارسنجی
  - [x] 2.1 ایجاد اسکریپت‌های اعتبارسنجی
    - پیاده‌سازی تابع `validate_file_size`
    - پیاده‌سازی تابع `detect_html_content`
    - پیاده‌سازی تابع `validate_zip_integrity`
    - پیاده‌سازی تابع `validate_component` کامل
    - _الزامات: ۲.۱، ۲.۲، ۲.۳_

  - [x] 2.2 نوشتن تست خصوصیت برای اعتبارسنجی اندازه فایل
    - **خصوصیت ۱: اعتبارسنجی اندازه فایل جامع**
    - **اعتبارسنجی: الزامات ۲.۱، ۶.۱-۶.۱۱**

  - [x] 2.3 نوشتن تست خصوصیت برای تشخیص HTML
    - **خصوصیت ۲: تشخیص محتوای HTML**
    - **اعتبارسنجی: الزامات ۲.۳، ۵.۴**

- [x] 3. پیاده‌سازی دانلود کامپوننت‌های اصلی
  - [x] 3.1 دانلود Android Studio و JDK
    - اضافه کردن step دانلود Android Studio 2022.3.1
    - اضافه کردن step دانلود JDK 17
    - پیاده‌سازی اعتبارسنجی برای هر کدام
    - _الزامات: ۱.۱، ۱.۲_

  - [x] 3.2 دانلود نسخه‌های مختلف Gradle
    - اضافه کردن step دانلود Gradle 8.1
    - اضافه کردن step دانلود Gradle 8.0.2
    - اضافه کردن step دانلود Gradle 7.6.3
    - اضافه کردن step دانلود Gradle 7.5
    - _الزامات: ۱.۳_

  - [x] 3.3 نوشتن تست خصوصیت برای نسخه‌های متعدد
    - **خصوصیت ۳: یکپارچگی فایل‌های ZIP**
    - **اعتبارسنجی: الزامات ۲.۲**

- [x] 4. پیاده‌سازی دانلود کامپوننت‌های SDK
  - [x] 4.1 دانلود Command Line Tools و Platform Tools
    - اضافه کردن step دانلود Command Line Tools
    - اضافه کردن step دانلود Platform Tools نسخه‌های مختلف
    - پیاده‌سازی اعتبارسنجی مخصوص
    - _الزامات: ۱.۴، ۱.۵_

  - [x] 4.2 دانلود Build Tools و SDK Platforms
    - اضافه کردن step دانلود Build Tools نسخه‌های مختلف
    - اضافه کردن step دانلود SDK Platform API 33, 30, 27
    - _الزامات: ۱.۶، ۱.۷، ۱.۸، ۱.۹_

  - [x] 4.3 نوشتن تست خصوصیت برای URL های مستقیم
    - **خصوصیت ۵: URL های مستقیم باینری**
    - **اعتبارسنجی: الزامات ۵.۱، ۵.۳**

- [x] 5. پیاده‌سازی دانلود کامپوننت‌های Emulator و Repository
  - [x] 5.1 دانلود System Images و Emulator Engine
    - اضافه کردن step دانلود System Image API 33
    - اضافه کردن step دانلود Emulator Engine نسخه‌های مختلف
    - پیاده‌سازی اعتبارسنجی محدود برای emulator
    - _الزامات: ۱.۱۰، ۱.۱۱، ۱۲.۱، ۱۲.۲_

  - [x] 5.2 دانلود M2Repository ها و سایر کامپوننت‌ها
    - اضافه کردن step دانلود Android M2Repository نسخه‌های مختلف
    - اضافه کردن step دانلود Google M2Repository نسخه‌های مختلف
    - اضافه کردن step دانلود Sources، CMake، Constraint Layout
    - _الزامات: ۱.۱۲، ۱.۱۳، ۱.۱۴، ۱.۱۵، ۱.۱۶_

- [x] 6. پیاده‌سازی مدیریت خطا و گزارش‌دهی
  - [x] 6.1 پیاده‌سازی سیستم مدیریت خطا
    - اضافه کردن `continue-on-error: true` به تمام step ها
    - پیاده‌سازی ثبت خطاها در فایل JSON
    - پیاده‌سازی ادامه پردازش پس از خطا
    - _الزامات: ۴.۱، ۴.۲، ۴.۳، ۴.۷_

  - [x] 6.2 نوشتن تست خصوصیت برای مدیریت خطا
    - **خصوصیت ۴: ادامه پردازش پس از خطا**
    - **اعتبارسنجی: الزامات ۴.۱، ۴.۷**

  - [x] 6.3 پیاده‌سازی تولید گزارش JSON
    - ایجاد فایل `validation_results.json`
    - ثبت نتایج هر کامپوننت در JSON
    - تولید خلاصه نهایی
    - _الزامات: ۹.۱، ۹.۲، ۹.۳، ۹.۵_

  - [x] 6.4 نوشتن تست خصوصیت برای گزارش JSON
    - **خصوصیت ۷: تولید گزارش JSON کامل**
    - **اعتبارسنجی: الزامات ۹.۵**

- [x] 7. پیاده‌سازی فایل‌های لایسنس SDK
  - [x] 7.1 ایجاد فایل‌های لایسنس
    - ایجاد step برای تولید `android-sdk-license`
    - ایجاد step برای تولید `android-sdk-preview-license`
    - ایجاد step برای تولید `google-gdk-license`
    - آپلود فایل‌های لایسنس به عنوان artifact "sdk-licenses"
    - _الزامات: ۷.۱، ۷.۲، ۷.۳، ۷.۴، ۷.۵_

- [x] 8. پیاده‌سازی آپلود Artifacts
  - [x] 8.1 آپلود کامپوننت‌های اصلی
    - پیاده‌سازی آپلود JDK، Android Studio
    - پیاده‌سازی آپلود نسخه‌های مختلف Gradle
    - استفاده از نام‌های artifact مناسب
    - _الزامات: ۳.۱، ۳.۴، ۳.۵، ۳.۶_

  - [x] 8.2 آپلود کامپوننت‌های SDK و سایر موارد
    - پیاده‌سازی آپلود تمام کامپوننت‌های SDK
    - پیاده‌سازی آپلود کامپوننت‌های emulator و repository
    - _الزامات: ۳.۷، ۳.۸، ۳.۹، ۳.۱۰، ۳.۱۱_

  - [x] 8.3 نوشتن تست خصوصیت برای نام‌گذاری Artifacts
    - **خصوصیت ۶: نام‌گذاری Artifact های منحصربه‌فرد**
    - **اعتبارسنجی: الزامات ۳.۲، ۳.۳**

- [x] 9. Checkpoint اول - تست اولیه workflow
  - کامیت و push تغییرات به repository
  - اجرای workflow با GitHub CLI: `gh workflow run android-offline-complete.yml`
  - بررسی نتایج و لاگ‌ها با `gh run list` و `gh run view`
  - اصلاح مشکلات احتمالی

- [x] 10. بهینه‌سازی و تست کامل
  - [x] 10.1 بهینه‌سازی عملکرد workflow
    - بررسی زمان اجرا و بهینه‌سازی
    - بهبود پیام‌های لاگ
    - تست تمام مسیرهای خطا
    - _الزامات: ۴.۴، ۴.۵_

  - [x] 10.2 نوشتن تست خصوصیت برای قفل نسخه URL ها
    - **خصوصیت ۸: قفل نسخه URL ها**
    - **اعتبارسنجی: الزامات ۱۱.۱، ۱۱.۴**

  - [x] 10.3 تست نهایی و اعتبارسنجی
    - اجرای چندین بار workflow برای تست پایداری
    - دانلود و بررسی artifacts تولید شده
    - تست فایل‌های دانلود شده با اسکریپت PowerShell موجود
    - _الزامات: ۹.۴_

- [x] 11. Checkpoint نهایی - اطمینان از عملکرد کامل
  - اطمینان از موفقیت تمام تست‌ها، در صورت بروز مشکل از کاربر سوال کنید.

## یادداشت‌ها

- وظایف علامت‌گذاری شده با `*` اختیاری هستند و می‌توانند برای MVP سریع‌تر رد شوند
- هر وظیف به الزامات خاص ارجاع می‌دهد تا قابلیت ردیابی فراهم شود
- Checkpoint ها اطمینان از اعتبارسنجی تدریجی فراهم می‌کنند
- تست‌های خصوصیت خصوصیات جهانی صحت را اعتبارسنجی می‌کنند
- تست‌های واحد مثال‌های خاص و edge case ها را اعتبارسنجی می‌کنند
- تست عملی با GitHub CLI برای اطمینان از عملکرد واقعی ضروری است